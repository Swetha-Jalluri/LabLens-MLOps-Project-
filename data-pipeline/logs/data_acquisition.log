2025-10-28 08:11:15,519 - __main__ - INFO - Configuration loaded from c:\lab-lens\data-pipeline\configs\data_config.yaml
2025-10-28 08:11:16,839 - __main__ - INFO - [OK] Authenticated using application default credentials
2025-10-28 08:11:18,155 - __main__ - INFO - [OK] BigQuery connection test successful
2025-10-28 08:11:18,156 - __main__ - INFO - MIMIC Data Acquisition initialized successfully
2025-10-28 08:11:18,158 - __main__ - INFO - ============================================================
2025-10-28 08:11:18,160 - __main__ - INFO - Starting MIMIC-III Data Acquisition Pipeline
2025-10-28 08:11:18,164 - __main__ - INFO - ============================================================
2025-10-28 08:11:18,166 - __main__ - INFO - Fetching discharge summaries (dedupe first, then sample)...
2025-10-28 08:11:26,013 - __main__ - INFO - [OK] Fetched 5000 unique discharge summaries
2025-10-28 08:11:26,015 - __main__ - INFO -   Avg text length: 9584 characters
2025-10-28 08:11:26,016 - __main__ - INFO - Fetching demographics and admission data...
2025-10-28 08:11:28,216 - __main__ - INFO - [OK] Fetched 5000 demographic records
2025-10-28 08:11:28,219 - __main__ - INFO - Fetching lab results (scoped to discharge admissions)...
2025-10-28 08:11:33,763 - __main__ - INFO - [OK] Fetched 2075587 lab result records
2025-10-28 08:11:33,764 - __main__ - INFO - Fetching diagnoses (scoped to discharge admissions)...
2025-10-28 08:11:37,372 - __main__ - INFO - [OK] Fetched 58712 diagnosis records
2025-10-28 08:11:38,315 - __main__ - INFO - [OK] Aggregated lab results to 4950 admissions
2025-10-28 08:11:38,489 - __main__ - INFO - [OK] Aggregated diagnoses to 5000 admissions
2025-10-28 08:11:38,490 - __main__ - INFO - Merging all datasets...
2025-10-28 08:11:38,499 - __main__ - INFO -   After merge with demographics: 5000 rows (1:1 validated)
2025-10-28 08:11:38,509 - __main__ - INFO -   After merge with labs: 5000 rows (1:1 validated)
2025-10-28 08:11:38,515 - __main__ - INFO -   After merge with diagnoses: 5000 rows (1:1 validated)
2025-10-28 08:11:38,515 - __main__ - INFO - [OK] Final merged dataset shape: (5000, 19)
2025-10-28 08:11:38,516 - __main__ - INFO - Running data validation...
2025-10-28 08:11:38,519 - __main__ - INFO - [OK] Data validation PASSED
2025-10-28 08:11:38,523 - __main__ - ERROR - Failed to save data: NDFrame.to_csv() got an unexpected keyword argument 'line_terminator'
2025-10-28 08:11:38,524 - __main__ - ERROR - Pipeline failed: NDFrame.to_csv() got an unexpected keyword argument 'line_terminator'
Traceback (most recent call last):
  File "C:\Users\Admin\AppData\Local\Temp\ipykernel_4204\2774419251.py", line 347, in run_complete_pipeline
    output_path = self.save_data(merged_df)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Admin\AppData\Local\Temp\ipykernel_4204\2774419251.py", line 306, in save_data
    df.to_csv(
  File "c:\lab-lens\.venv\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
TypeError: NDFrame.to_csv() got an unexpected keyword argument 'line_terminator'
2025-10-28 08:13:13,402 - __main__ - INFO - Configuration loaded from c:\lab-lens\data-pipeline\configs\data_config.yaml
2025-10-28 08:13:14,498 - __main__ - INFO - [OK] Authenticated using application default credentials
2025-10-28 08:13:15,959 - __main__ - INFO - [OK] BigQuery connection test successful
2025-10-28 08:13:15,960 - __main__ - INFO - MIMIC Data Acquisition initialized successfully
2025-10-28 08:14:38,781 - __main__ - INFO - Configuration loaded from c:\lab-lens\data-pipeline\configs\data_config.yaml
2025-10-28 08:14:40,006 - __main__ - INFO - [OK] Authenticated using application default credentials
2025-10-28 08:14:41,202 - __main__ - INFO - [OK] BigQuery connection test successful
2025-10-28 08:14:41,204 - __main__ - INFO - MIMIC Data Acquisition initialized successfully
2025-10-28 08:17:29,108 - __main__ - INFO - Configuration loaded from c:\lab-lens\data-pipeline\configs\data_config.yaml
2025-10-28 08:17:30,291 - __main__ - INFO - [OK] Authenticated using application default credentials
2025-10-28 08:17:31,574 - __main__ - INFO - [OK] BigQuery connection test successful
2025-10-28 08:17:31,576 - __main__ - INFO - MIMIC Data Acquisition initialized successfully
2025-10-28 08:17:31,578 - __main__ - INFO - ============================================================
2025-10-28 08:17:31,580 - __main__ - INFO - Starting MIMIC-III Data Acquisition Pipeline
2025-10-28 08:17:31,583 - __main__ - INFO - ============================================================
2025-10-28 08:17:31,585 - __main__ - INFO - Fetching discharge summaries (dedupe first, then sample)...
2025-10-28 08:17:34,838 - __main__ - INFO - [OK] Fetched 5000 unique discharge summaries
2025-10-28 08:17:34,840 - __main__ - INFO - Fetching demographics and admission data...
2025-10-28 08:17:36,912 - __main__ - INFO - [OK] Fetched 5000 demographic records
2025-10-28 08:17:36,914 - __main__ - INFO - Fetching lab results (scoped to discharge admissions)...
2025-10-28 08:17:40,722 - __main__ - INFO - [OK] Fetched 2075587 lab result records
2025-10-28 08:17:40,723 - __main__ - INFO - Fetching diagnoses (scoped to discharge admissions)...
2025-10-28 08:17:42,838 - __main__ - INFO - [OK] Fetched 58712 diagnosis records
2025-10-28 08:17:43,537 - __main__ - INFO - [OK] Aggregated lab results to 4950 admissions
2025-10-28 08:17:43,638 - __main__ - INFO - [OK] Aggregated diagnoses to 5000 admissions
2025-10-28 08:17:43,640 - __main__ - INFO - Merging all datasets...
2025-10-28 08:17:43,646 - __main__ - INFO -   After merge with demographics: 5000 rows (1:1 validated)
2025-10-28 08:17:43,650 - __main__ - INFO -   After merge with labs: 5000 rows (1:1 validated)
2025-10-28 08:17:43,655 - __main__ - INFO -   After merge with diagnoses: 5000 rows (1:1 validated)
2025-10-28 08:17:43,656 - __main__ - INFO - [OK] Final merged dataset shape: (5000, 19)
2025-10-28 08:17:43,657 - __main__ - INFO - Running data validation...
2025-10-28 08:17:43,660 - __main__ - INFO - [OK] Data validation PASSED
2025-10-28 08:17:44,351 - __main__ - INFO - [OK] Data saved
2025-10-28 08:17:44,352 - __main__ - INFO -   Path: C:\lab-lens\data-pipeline\data\raw\mimic_discharge_with_demographics.csv
2025-10-28 08:17:44,354 - __main__ - INFO -   Size: 47.05 MB
2025-10-28 08:17:44,355 - __main__ - INFO -   Rows: 5000, Columns: 18
2025-10-28 08:17:44,356 - __main__ - INFO - ============================================================
2025-10-28 08:17:44,357 - __main__ - INFO - [OK] Pipeline completed successfully!
2025-10-28 08:17:44,357 - __main__ - INFO - ============================================================
